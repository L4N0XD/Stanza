{% include "header.html" %}

<button id="startProgress"  onclick="startProgressBar()" style="display: none;">comecar</button>
<form method="POST" action="{% url 'upload-rh' %}" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="input-group mb-3" style="width: 600px; height: 100px; margin: auto; margin-top: 15%;">
        <div id="divProgress" class="progress" role="progressbar" aria-label="Basic example" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 500px; display: none; border-radius: 10px;" >
            <div class="progress-bar"  id="progresso" style="width: 0%; position: relative; z-index: 0; background: orange;"></div>
            <p id="text_progress" style="position: absolute; z-index: 1; text-align: center; left: 42%; transform: translateX(-50%); color: orange"></p>
        </div>
        <div style="display: grid;" id="uploadRH">
            <div  class="divInput form-group mb-4"style="width:500px; height:40px; display:flex;  border-radius: 6px; align-items: baseline;">
              <p class="text-dark input-label" style="width:50%; text-align: center;">Planilha Real</p>
                <input type="file" required class="form-control input-file" id="arquivo1" name="arquivo1">
            </div>
            <div class="divInput form-group mb-4"style="width:500px; height:40px; display:flex; border-radius: 6px; align-items: baseline;">
              <p class="text-dark input-label" style="width:50%; text-align: center;">Planilha AracajuCard</p>
              <input type="file" required class="form-control input-file" id="arquivo2" name="arquivo2">
            </div>
              <button id="startUpload" class="btn btn-outline-success d-flex mb-4" style="justify-content: center;" type="submit">Upload</button>
        </div>
        </div>
    </form>
    <style>
    #arquivo1::-webkit-file-upload-button {display: none;}
    #arquivo2::-webkit-file-upload-button {display: none;}
    .divInput {background-color:white;}
    .divInput:hover {background-color: #f8f8ff;}
    .input-label {cursor: pointer;}
    </style>
    <script>
      
    const startUpload = document.querySelector('#startUpload')
    const startProgress = document.querySelector('#startProgress')
    const divProgress = document.querySelector('#divProgress')
    startUpload.addEventListener('click', () => startProgress.click())
  function startProgressBar() {
      var progressBar = document.querySelector('#progresso')
      var textProgress = document.querySelector('#text_progress')
      var formUpload = document.querySelector('#uploadRH')
      formUpload.style.display = 'none'
      divProgress.style.display = 'flex'
      var width = 0;
      var index = 0;
      var id = setInterval(frame, 30);
      const loadTexts = ["Carregando...","Por favor, aguarde...","Lendo o arquivo...","Processando os dados...","Carregando informações...","Quase lá...","Finalizando a leitura...", "Pronto!"];
  
      
      function frame() {
        if (width >= 100) {
          clearInterval(id);
          textProgress.textContent = 'Redirecionando...'
        } else {
            if (width % 14 == 0) {
              textProgress.textContent = loadTexts[index];
              index++
            }
            if (width == 42) {
                textProgress.style.color = 'white';
            }
          width++
          progressBar.style.width = width + '%';
        }
      }
  }
    </script>
    <script>
      inputLabel = document.querySelectorAll('.input-label')
      inputFile = document.querySelectorAll('.input-file')
      inputLabel
      inputLabel[0].addEventListener('click', () => inputFile[0].click())
      inputLabel[1].addEventListener('click', () => inputFile[1].click())
    </script>
</body>
</html>